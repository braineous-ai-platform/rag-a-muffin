# üß© CGO v0.2.0 ‚Äî Substrate Freeze: Atomic Facts Only, Rulegen Parked

**Date:** November 11, 2025  
**Author:** Sohil Shah (@braineous-engineering)  
**Repo:** [BraineousAI / rag-a-muffin](https://github.com/braineous-ai-platform/rag-a-muffin)

---

## üîñ Summary

This release freezes the **Causal Graph Orchestrator (CGO)** substrate as a stable foundation for future reasoning and rulepack layers.  
The **AppProducer** now emits **atomic Facts only**, and all rule generation logic (`rulegen`) has been decoupled pending activation of the formal `RulepackTemplate` layer.

The goal of v0.2.0 is to lock in a deterministic, minimal graph substrate ‚Äî one that other domains (policy reasoning, data migration, LLM overlays) can build upon safely.

---

## üß± Core Concepts

### ‚úÖ Stable Graph Substrate

- **Facts** are the atomic building blocks (non-relational nodes).
- **Edges** are optional relational links derived externally.
- **GraphAssembler** ensures deterministic sorting + snapshot hashing for reproducibility.
- **Validator** interface defined, but logic is deferred to Rulepack layer.

### üö´ Rulegen Decoupling

Rule generation (`inferRules`, `RuleEdge`, etc.) has been **temporarily removed** from the `AppProducer` contract.
This keeps the core CGO runtime focused on _data emission and validation only_.

### ‚öôÔ∏è Validation (Lambda Model)

The **validator** remains a functional interface in the substrate:

```java
@FunctionalInterface
public interface FactValidator {
    ValidationResult validate(Fact fact, Map<String, Object> config);
}
```

Implementations (e.g., regex, required fields, uniqueness) will live in the upcoming Rulepack layer as data-driven lambdas.

### üß© Rulepack Preview

Status: Deferred until v0.3.0+
Validators and rules will live in a JSON-driven manifest like:

```json
{
  "meta": { "name": "core-airport-substrate", "version": "0.2.0" },
  "validators": [
    {
      "id": "airport.id.regex",
      "applies_to": { "kind": "Airport" },
      "use": "builtin.regex",
      "config": { "field": "id", "pattern": "^[A-Z]{3}$" },
      "severity": "ERROR",
      "on_fail": "reject"
    }
  ]
}
```

The Rulepack layer will provide deterministic sequencing, severity thresholds, and namespace isolation for domain-specific validation and inference.

### üß† Design Guardrails (Generic COG Pattern)

- Freeze substrate ‚Äî deterministic graph, stable snapshot hash.

- Namespaced context ‚Äî all nodes, edges, rules exist under isolated domains.

- Model-agnostic protocol ‚Äî LLMs and rule engines both use same JSON schema.

- Determinism ‚Äî enforced by stable sorting and hash-based reproducibility.

- Outcome loop ‚Äî every overlay produces measurable weight deltas for reasoning feedback.

### üì¶ Structure Overview

| Layer               | Description                       | Status    |
| ------------------- | --------------------------------- | --------- |
| Substrate           | Fact / Graph core                 | ‚úÖ Stable |
| Validator Interface | Functional contract               | ‚úÖ Stable |
| Rulepack Layer      | Declarative validator & rule JSON | üöß Next   |
| Scoring / Outcome   | Overlay analytics                 | ‚è∏ Future  |
| Persistence         | Serialization & snapshot          | ‚è∏ Future  |

### üß™ Quickstart

Run the deterministic fact validation test suite (Flight Network Orchestrator example):

```
cd <project_root>/rag-a-muffin/prompt_engineering_quarkus

mvn -q -Dtest=FNOOrchestratorTests test
```

Expected output:

```
____src_airport____
{"id":"Airport:AUS","kind":"Airport","mode":"atomic"}
____dst_airport____
{"id":"Airport:AUS","kind":"Airport","mode":"atomic"}
____flight____
{"id":"F100","kind":"Flight","mode":"relational","from":"AUS","to":"DFW"}
____src_airport____
{"id":"Airport:AUS","kind":"Airport","mode":"atomic"}
____dst_airport____
{"id":"Airport:AUS","kind":"Airport","mode":"atomic"}
____flight____
{"id":"F102","kind":"Flight","mode":"relational","from":"AUS","to":"DFW"}
____src_airport____
{"id":"Airport:SAT","kind":"Airport","mode":"atomic"}
____dst_airport____
{"id":"Airport:SAT","kind":"Airport","mode":"atomic"}
____flight____
{"id":"F110","kind":"Flight","mode":"relational","from":"SAT","to":"DFW"}
____src_airport____
{"id":"Airport:IAH","kind":"Airport","mode":"atomic"}
____dst_airport____
{"id":"Airport:IAH","kind":"Airport","mode":"atomic"}
____flight____
{"id":"F120","kind":"Flight","mode":"relational","from":"IAH","to":"DFW"}
____src_airport____
{"id":"Airport:DFW","kind":"Airport","mode":"atomic"}
____dst_airport____
{"id":"Airport:DFW","kind":"Airport","mode":"atomic"}
____flight____
{"id":"F200","kind":"Flight","mode":"relational","from":"DFW","to":"ORD"}
____src_airport____
{"id":"Airport:DFW","kind":"Airport","mode":"atomic"}
____dst_airport____
{"id":"Airport:DFW","kind":"Airport","mode":"atomic"}
____flight____
{"id":"F210","kind":"Flight","mode":"relational","from":"DFW","to":"JFK"}
____src_airport____
{"id":"Airport:DFW","kind":"Airport","mode":"atomic"}
____dst_airport____
{"id":"Airport:DFW","kind":"Airport","mode":"atomic"}
____flight____
{"id":"F220","kind":"Flight","mode":"relational","from":"DFW","to":"LAX"}
____causal_rule_engine_facts____
[Fact [id=Airport:AUS, text={"id":"Airport:AUS","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Airport:DFW, text={"id":"Airport:DFW","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Flight:F100, text={"id":"F100","kind":"Flight","mode":"relational","from":"AUS","to":"DFW"}, feats=null], Fact [id=Airport:AUS, text={"id":"Airport:AUS","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Airport:DFW, text={"id":"Airport:DFW","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Flight:F102, text={"id":"F102","kind":"Flight","mode":"relational","from":"AUS","to":"DFW"}, feats=null], Fact [id=Airport:SAT, text={"id":"Airport:SAT","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Airport:DFW, text={"id":"Airport:DFW","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Flight:F110, text={"id":"F110","kind":"Flight","mode":"relational","from":"SAT","to":"DFW"}, feats=null], Fact [id=Airport:IAH, text={"id":"Airport:IAH","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Airport:DFW, text={"id":"Airport:DFW","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Flight:F120, text={"id":"F120","kind":"Flight","mode":"relational","from":"IAH","to":"DFW"}, feats=null], Fact [id=Airport:DFW, text={"id":"Airport:DFW","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Airport:ORD, text={"id":"Airport:ORD","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Flight:F200, text={"id":"F200","kind":"Flight","mode":"relational","from":"DFW","to":"ORD"}, feats=null], Fact [id=Airport:DFW, text={"id":"Airport:DFW","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Airport:JFK, text={"id":"Airport:JFK","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Flight:F210, text={"id":"F210","kind":"Flight","mode":"relational","from":"DFW","to":"JFK"}, feats=null], Fact [id=Airport:DFW, text={"id":"Airport:DFW","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Airport:LAX, text={"id":"Airport:LAX","kind":"Airport","mode":"atomic"}, feats=null], Fact [id=Flight:F220, text={"id":"F220","kind":"Flight","mode":"relational","from":"DFW","to":"LAX"}, feats=null]]
```

### üìú Commit Log Summary

| Commit    | Message                                                                |
| --------- | ---------------------------------------------------------------------- |
| `abc1234` | cleanup(AppProducer): decouple rulegen stage until rulepack activation |
| `def5678` | docs: update README with CGO snapshot + guardrails                     |
| `ghi7890` | chore: add CONTRIBUTING and CHANGELOG entries                          |

---

### üß≠ Next Steps

v0.3.0 Roadmap

- Add RulepackTemplate.json loader and registry.

- Introduce built-in validators (regex, required, unique).

- Create RulepackExecutor with fail-fast logic.

- Begin serialization/persistence hooks (S3-ready).

### üß© Related Documentation

| File                                                   | Purpose                             |
| ------------------------------------------------------ | ----------------------------------- |
| [`docs/architecture.md`](../architecture.md)           | Full component overview             |
| [`docs/validator_design.md`](../validator_design.md)   | Lambda-based validator architecture |
| [`docs/rulepack_template.md`](../rulepack_template.md) | Declarative rulepack schema draft   |

### ü™∂ Author Note

This milestone stabilizes the substrate so future AI reasoning layers ‚Äî including LLM adapters ‚Äî can evolve on top of a tested, deterministic base.
CGO remains Java-only for now; cross-language adapters will follow after serialization is finalized.

**Tag:** v0.2.0  
**Branch:** main  
**Released:** November 11, 2025

---
